### 리팩터링의 정의
- 명사: 소프트웨어의 겉보기 동작은 그대로 유지한 채, 코드를 이해하고 수정하기 쉽도록 내부 구조를 변경하는 기법
- 동사: 소프트웨어의 겉보기 동작은 그대로 유지한 채, 여러가지 리팩터링 기법을 적용해서 소프트웨어를 재구성하다.

**즉, 리팩터링 동안에는 코드가 항상 정상 작동하고, 원하면 언제든 멈출 수 있으며, 리팩터링 도중 코드가 깨지면 리팩터링이 아니다.**

### 리팩터링하는 이유
- 소프트웨어 설계가 좋아진다.
    - 코드량이 줄어들어 수정하기 쉬워진다.
- 소프트웨어를 이해하기 쉬워진다.
    - 다른 사람뿐만 아니라 나 자신도 코드를 이해하기 쉬워진다.
- 버그를 쉽게 찾을 수 있다.
    - 코드가 하는 일을 깊이 파악하게 되면서 버그가 명확해진다.
- 프로그래밍 속도를 높일 수 있다.
    - 새로운 기능을 추가할 때 추가할 지점과 수정 사항을 명확하게 파악할 수 있다.

### 언제 리팩터링해야 할까?
- 준비를 위한 리팩터링
    - 코드베이스에 기능을 새로 추가하기 직전
- 이해를 위한 리팩터링
    - 코드를 파악할 때
- 쓰레기 줍기 리팩터링
    - 코드를 파악하던 중 비효율적으로 처리하는 모습을 발견할 때
- 수시로 하는 리팩터링
    - 기능을 추가하거나 버그를 잡는 동안
- 오래 걸리는 리팩터링
    - 라이브러리를 교체하거나 일부 코드를 컴포넌트로 빼내는 작업 등을 할 때
        - 몇주에 걸쳐 조금씩 해결하는 편이 효과적일 때가 많다.
- 코드 리뷰에 리팩터링 활용
    - 개선안들을 제시하는 데서 그치지 않고, 상당수를 즉시 구현해볼 수 있다.
- 관리자에게 뭐라고 말해야 할까?
    - 프로 개발자에게 주어진 임무는 새로운 기능을 빠르게 구현하는 것이고, 가장 빠른 방법은 리팩터링이다.
- 리팩터링하지 말아야 할 때
    - 외부 API 다루듯 호출해서 쓰는 코드
    - 리팩터링하는 것보다 처음부터 새로 작성하는 게 쉬울 때

### 리팩터링 시 고려할 문제
- 새 기능 속도 저하
    - 리팩터링의 본질은 오로지 개발 기간을 단축하고자 하는 것이다.
- 코드 소유권
    - 코드 소유권을 팀에 둬 다른 사람도 수정할 수 있게끔 한다.
    - 다른 팀의 코드인 경우 오픈소스 처럼 브랜치를 따서 수정하고 커밋을 요청한다.
- 브랜치
    - 지속적인 통합을 통해 통합 주기를 짧게 잡아서 리팩터링 코드의 머지 시 발생하는 문제를 예방한다.
- 테스팅
    - 리팩터링하기 위해서는 자가 테스트 코드를 마련해야 한다.
- 레거시 코드
    - 레거시 시스템을 파악할 때 리팩터링이 굉장히 도움된다.
        - 하지만, 대부분 테스트코드가 없어 테스트 보강을 해야한다.
        - 테스트를 추가할 틈새를 찾아서 시스템을 테스트해야 하는데 이러한 틈새를 만들 때 리팩터링이 활용된다.
- 데이터베이스
    - 버전 관리 시스템을 이용해 점진적으로 개선한다.

### 리팩터링, 아키텍처, 애그니(YAGNI)
- 현재까지 파악한 요구사항만 해결하도록 구축한 후, 진행하면서 요구사항을 잘 이해하게 되면 아키텍처도 그에 맞게 리팩터링 한다.
- 이런 식으로 설계하는 방식을 간결한 설계, 점진적 설계, YAGNI (you aren't hoing to need it) 라고 부른다.

### 리팩터링과 소프트웨어 개발 프로세스
- 리팩터링의 첫 번째 토대는 자가 테스트 코드이다.
- 각 팀원이 다른 사람의 작업을 방해하지 않으면서 언제든지 리팩터링할 수 있어야 하는데, 지속적 통합으로 해결 가능하다.
- 자가 테스트 코드, 지속적 통합, 리팩터링은 서로 강력한 상승효과를 발휘한다.
- 이를 갖추면 지속적 배포를 통해 언제든 릴리스할 수 있는 상태로 유지할 수 있게해 위험요소를 줄이고프로덕션 코드로 반영하는 시간을 엄청 단축해준다.

### 리팩터링과 성능
- 리팩터링을 하면 성능이 느려진다는 걱정이 있지만 오히려 성능을 튜닝하기 쉬워진다.
- 리팩터링이 잘 되어 있다면 기능 추가가 빨리 끝나서 성능에 집중할 시간을 더 벌 수 있다.
- 리팩터링이 잘 되어 있는 프로그램은 성능을 더 세밀하게 분석할 수 있다.
- 단기적으로 리팩터링 단계에서 성능이 느려질 수 있지만, 최적화 단계에서 코드를 튜닝하기 훨씬 쉬워지기 때문에 결과적으로 더 빠른 소프트웨어를 얻는다.

### 리팩터링 자동화
- 정적 타입 언어는 안전하게 자동으로 리팩터링을 처리할 수 있다.